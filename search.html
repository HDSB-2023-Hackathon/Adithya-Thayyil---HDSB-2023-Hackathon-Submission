<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlantCare - Search</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>

<body>
    <div class="container">
        <h1>PlantCare: Species Search</h1>
        <form id="search-form">
            <div class="input-group mb-3">
                <input type="text" class="form-control" placeholder="Search for your plants" id="search-input">
                <div class="input-group-append">
                    <button class="btn btn-outline-success" type="submit">Search</button>
                </div>
            </div>
            <div class="form-group">
                <label>Filter:</label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="filter" id="filter-indoor" value="indoor">
                    <label class="form-check-label" for="filter-indoor">
                        Indoor
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="filter" id="filter-outdoor" value="outdoor">
                    <label class="form-check-label" for="filter-outdoor">
                        Outdoor
                    </label>
                </div>
            </div>
        </form>
        <div id="results"></div>
    </div>
    <!-- jQuery and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script>
        $(document).ready(function () {
            // When the search form is submitted
            $("#search-form").submit(function (event) {
                // Prevent the form from submitting normally
                event.preventDefault();

                // Get the search query from the input
                var query = $("#search-input").val();

                // Get the filter option
                var filter = $("input[name='filter']:checked").val();

                // Set the filter parameter based on the selected option
                var filterParam = '';
                if (filter === 'indoor') {
                    filterParam = '&indoor=1';
                } else if (filter === 'outdoor') {
                    filterParam = '&indoor=0';
                }

                // Make the API request with the search query and filter parameter
                fetch("https://perenual.com/api/species-list?&key{KEY}&q=" + query + filterParam)
                    .then(response => response.json())
                    .then(response => {
                        // Clear previous search results
                        $("#results").empty();

                        console.log(response);

                        Object.keys(response.data).forEach(function (key) {
                            // console.log(response.data[key].common_name)

                            console.log(response.data[key].sunlight[0]);


                            const imageLink = response.data[key].default_image.small_url;
                            const imageContainer = $("<div></div>");
                            const image = $("<img></img>");
                            image.attr("src", imageLink);
                            imageContainer.append(image);

                            $("#results").append("<h2>" + response.data[key].common_name + "</h2>");
                            $("#results").append(imageContainer);
                            $("#results").append("<p> Cycle: " + response.data[key].cycle + "</p>");
                            $("#results").append("<p> Watering: " + response.data[key].watering + "</p>");
                            $("#results").append("<p> Sunlight: " + response.data[key].sunlight[0] + "</p>");  // TODO: Loop through array
                            $("#results").append("<button type='button' class='btn btn-success'> Watering Guide/Timer" + "</button> ");

                            $("#results").append("<hr>");

                        })
                    });
            });
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</body>

</html>